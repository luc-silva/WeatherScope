(()=>{"use strict";async function e(e="London",t="metric"){try{let n=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${e}&APPID=67556afc5b803ebc6540b49ddb13c6a3&units=${t}`);return await n.json()}catch(e){throw new Error(`Wasn't possible to fetch data from API. ${e}`)}}let t={temperatureUnit:"metric",city:"London"},n=function(){let e,t=()=>document.createElement("div");return{createSearchContainer:function(){let e=t();e.id="clock-search-container";let n=t();n.id="search-container";let r=document.createElement("input");r.placeholder="Type a city here...",r.id="search-input";let i=document.createElement("button");i.addEventListener("click",(()=>{console.log(r.value),a(r.value)})),i.textContent="Search",i.id="search-btn",n.append(r,i);let c=document.createElement("strong");c.id="weather-clock";let o=t();return o.append(c),e.append(n,o),e},changeBackground:function(e){document.querySelector("#weather-app-image").style.backgroundImage=`url(${e})`},updateClock:function(){e=setInterval(r,3e3)},stopClock:function(){clearInterval(e),e=null},createWeatherCardContainer:function(){let e=t();return e.id="weather-card-container",e},createWeatherCard:function(e){let n=t();return n.classList.add("weather-card"),n.innerHTML=`\n        <span class="weather-card-city">${e.name}, ${e.sys.country}</span>\n        <div class="weather-card-status-container">\n            <div class="weather-card-status">\n                <span>${Math.round(e.main.temp)}°C</span> /\n                <span>${Math.round(1.8*e.main.temp+32)}°F</span>\n            </div>\n            <div class="weather-card-condition">\n                ${e.weather[0].description}\n                <img src="http://openweathermap.org/img/wn/${e.weather[0].icon}@2x.png"></img>\n            </div>\n        </div>`,n},createCityContainer:function(e){let n=document.querySelector("#weather-card-container"),a=t();a.id="weather-city-container-card";let r=t();r.id="weather-city-container-info";let i=t();i.innerHTML=`\n\t\t<div>\n\t\t\t<h2>${e.name} - ${e.sys.country}</h2>\n\t\t\t<p>${e.weather[0].description}</p>\n\t\t</div>`;let c=t();c.id="weather-city-container-info-stts",c.innerHTML=`\n\t\t<span><strong>Humidity: </strong>${e.main.humidity}%</span>\n\t\t<span><strong>Temp Min: </strong>${e.main.temp_min}°C</span>\n\t\t<span><strong>Temp Max: </strong>${e.main.temp_max}°C</span>`,r.append(i,c);let o=t();if(o.id="weather-city-container-img",o.innerHTML=`\n\t\t<h3>${e.main.temp}°C</h3>\n\t\t<img src="http://openweathermap.org/img/wn/${e.weather[0].icon}@2x.png">`,a.append(r,o),"weather-city-container-card"!=n.firstChild.id)n.prepend(a);else{let e=n.querySelectorAll("div");n.removeChild(e[0]),n.prepend(a)}}}}(),a=async function(t){let a=await e(t);n.createCityContainer(a)};function r(){let e=new Date,t=e.getHours(),n=e.getMinutes();n<10&&(n="0"+n),document.querySelector("#weather-clock").textContent=`${t}:${n}`}let i=async function(){n.stopClock();let e=document.querySelector("#main-container");e.textContent="";let a=document.createElement("div");a.id="settings-container";let r=document.createElement("h2");r.textContent="Settings:";let i=document.createElement("div");i.textContent="Default city: (City that shows on the main display)";let c=document.createElement("input");c.id="default-city-input",c.value=t.city,i.append(c);let o=document.createElement("div");o.textContent="Unit:";let d=document.createElement("select");d.value=t.temperatureUnit,d.id="default-unit-input",d.innerHTML='\n\t<option value="metric">Metric</option>\n\t<option value="imperial">Imperial</option>',o.append(d);let l=document.createElement("button");l.id="settings-submit",l.textContent="Submit Changes",l.addEventListener("click",(()=>{t.city=c.value,t.temperatureUnit=d.value})),a.append(r,i,o,l),e.append(a)},c=async function(){let t=document.querySelector("#main-container");t.textContent="";let a=n.createSearchContainer(),r=n.createWeatherCardContainer();t.append(a,r),n.updateClock();let i=["London","Brasilia","Washington","Berlin","Moscow","Tokyo","Mexico City"];for(let t=0;t<i.length;t++){let a=await e(i[t]),r=n.createWeatherCard(a);document.querySelector("#weather-card-container").append(r)}},o=(async function(){let a=document.querySelector("#weather-temperature"),r=await e(),d=async function(){"metric"==t.temperatureUnit?(t.temperatureUnit="imperial",r=await e(t.city,t.temperatureUnit),a.textContent=`${r.main.temp}°F`):(t.temperatureUnit="metric",r=await e(t.city,t.temperatureUnit),a.textContent=`${r.main.temp}°C`),l(),u()},l=function(){let e=document.querySelector("#weather-status"),t=r.weather[0].description;switch(t=o(t),e.textContent=`${t}`,r.weather[0].main){case"Rain":n.changeBackground("../src/img/raining.jpg");break;case"Thunderstorm":n.changeBackground("../src/img/thunderstorm.jpg");break;case"Clouds":n.changeBackground("../src/img/cloudy.jpg");break;case"Snow":n.changeBackground("../src/img/snow.jpg");break;case"Drizzle":n.changeBackground("../src/img/drizzle.jpg");break;default:n.changeBackground("../src/img/clear.jpg")}},u=function(){document.querySelector("#weather-city").textContent=r.name};document.querySelector("#settings-button").addEventListener("click",i),document.querySelector("#weather-tab-btn").addEventListener("click",c),a.addEventListener("click",d),d()}(),e=>{e=e.split(" ");let t=[];return e.forEach((e=>{(e=e.split(""))[0]=e[0].toUpperCase(),e=e.join(""),t.push(e)})),t=t.join(" "),t})})();